name: Build
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v3
        with:
          java-version: '17'
      - run: |
          # Crear archivos mÃ­nimos
          mkdir -p app/src/main/java/com/thundertools
          echo 'plugins { id("com.android.application"); id("org.jetbrains.kotlin.android") }' > app/build.gradle.kts
          echo 'android { namespace = "com.thundertools"; compileSdk = 34 }' >> app/build.gradle.kts
          echo 'dependencies { implementation("androidx.core:core-ktx:1.12.0") }' >> app/build.gradle.kts
          
          echo 'package com.thundertools' > app/src/main/java/com/thundertools/MainActivity.kt
          echo 'class MainActivity' >> app/src/main/java/com/thundertools/MainActivity.kt
          
          # Crear wrapper
          echo 'distributionUrl=https://services.gradle.org/distributions/gradle-8.2-bin.zip' > gradle-wrapper.properties
          mkdir -p gradle/wrapper
          mv gradle-wrapper.properties gradle/wrapper/
          
          # Compilar
          sudo apt update
          sudo apt install -y gradle
          gradle wrapper --gradle-version=8.2
          chmod +x gradlew
          ./gradlew assembleDebug
      - uses: actions/upload-artifact@v4
        with:
          name: apk
          path: app/build/outputs/apk/debug/*.apk